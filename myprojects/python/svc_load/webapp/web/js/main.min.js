function request(e,t,a){var o=document.createElement("div");document.body.appendChild(o);var s=new Spinner(CONSTANT.SPIN.opts).spin(o),r=iosOverlay({text:"Loading",spinner:s});return $.ajax({type:t,url:e,data:a,dataType:"json",success:function(e){1==e.status?(r.update({icon:"img/check.png",text:"Success",duration:2e3}),setTimeout(function(){r.hide()},2e3)):(r.update({icon:"img/cross.png",text:e.msg,duration:2e3}),setTimeout(function(){r.hide()},2e3)),document.body.removeChild(o)},error:function(){r.hide(),document.body.removeChild(o),$("#errorModal div.modal-body").text("internal error!"),$("#errorModal").modal({keyboard:!0})}}),!1}$(document).ready(function(){function e(){var e;$.ajax({type:"GET",url:CONSTANT.URL.SVC.GET_USER_PROFILE,dataType:"json",success:function(t){var a=t.data;if(1==t.status){if(e=a.name,!a.is_super)switch($("#svc_admin").remove(),a.group){case"dev":$("#test_group").remove();break;case"testgroup":$("#svc").remove();break;default:$("#left-nav").empty(),$("#sub-page").html("<h1><strong>无任何权限，请联系管理员！</strong></h1>")}$("#left-nav").show(),$("#left-nav ul:eq(0) li:eq(1)").trigger("click")}else e="未登录";$("#user_name").html(e)}})}function t(){$.ajax({type:"POST",url:CONSTANT.URL.SVC.CHANGE_PASSWORD,data:$("#password-form").serialize(),dataType:"json",success:function(){$("#pwdModal").modal("hide")}})}function a(){$("input[type='password']").val(""),$("#password_form").formValidation("resetForm",!0)}function o(e){if($("#sub-page").html(),"locust"==e)$.ajax({type:"GET",url:CONSTANT.URL.SVC.GET_LOCUST_MASTER_URL,timeout:3e3,dataType:"json",datafilter:function(){},success:function(e){if("1"!=e.status)alert("请先启动locust master！"),$("#operation").trigger("click");else{var t=e.data.locust_master,a='<iframe id="locust" name="locust" src="http://'+t+':8089" style="overflow:visible;min-height:800px;" scrolling="yes" frameborder="no" height="100%" width="100%"></iframe>';$("#sub-page").html(a)}}});else if("service_mgr"==e){var t='<iframe id="service_mgr" name="service_mgr" src="http://172.16.16.72:5000" style="overflow:visible;min-height:800px;" scrolling="yes" frameborder="no" height="100%" width="100%"></iframe>';$("#sub-page").html(t)}else e="html/"+e,$.ajax({type:"GET",url:e,dataType:"html",success:function(e){$("#sub-page").html(e)}})}e(),String.prototype.format=function(e){var t=this;if(arguments.length>0)if(1==arguments.length&&"object"==typeof e){for(var a in e)if(void 0!=e[a]){var o=new RegExp("({"+a+"})","g");t=t.replace(o,e[a])}}else for(var s=0;s<arguments.length;s++)if(void 0!=arguments[s]){var o=new RegExp("({)"+s+"(})","g");t=t.replace(o,arguments[s])}return t},$("#password_form").formValidation({button:{selector:"#sub_pwd_btn",disabled:"disabled"},exculded:":disabled",live:"disabled",icon:CONSTANT.VALIDATE_OPTION.icon,fields:{password1:{validators:{notEmpty:{message:"密码不能为空"}}},password2:{validators:{notEmpty:{message:"密码不能为空"},identical:{field:"password1",message:"两次输入的密码不一致"}}}}}).on("err.form.fv",function(e){e.preventDefault()}).on("success.form.fv",function(e){t(),e.preventDefault()}),$("#left-nav li[data-url]").click(function(){clearInterval(TIMER),$("#left-nav li").each(function(){$(this).removeClass("active")}),$(this).addClass("active");var e=$(this).data("url");e&&o(e)}),$("#logout").click(function(){$.ajax({type:"GET",url:CONSTANT.URL.SVC.USER_LOGOUT,dataType:"json",success:function(e){window.location.href=e.msg}})}),$("#pwdModal").on("hide.bs.modal",function(){a()})});